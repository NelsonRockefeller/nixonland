campaignTrail_temp.cyoa = true;
e=campaignTrail_temp
// vars
var goldwater = 0;
var lodge = 0
var knowland = 0;
var straton = 0;
var mckay = 0;
e.noCounter = 0

const targetNode = document.getElementById("game_window");
const config = { attributes: true, childList: true, subtree: true };

function onGameWindowChanged(mutationList, observer) {
	updateQuestionBanner();
}

const observer = new MutationObserver(onGameWindowChanged);
observer.observe(targetNode, config);

function updateQuestionBanner() {
	let questionBanner = document.getElementById("campaign_sign");
	if(!questionBanner || questionBanner.nodeName != "DIV") return;
	let img = document.createElement('img');
	if(reveal == 0){
        img.src = 'https://i.imgur.com/11TkISC.jpeg';
    }
    else if(lodge == 1){
        img.src = 'https://i.imgur.com/B2B13O5.jpeg';
    }
    else if(goldwater == 1){
        img.src = 'https://i.imgur.com/svyPi2I.jpeg';
    }
    else if(straton == 1){
        img.src = 'https://i.imgur.com/UwS2ICY.jpeg';
    }
    else if(mckay == 1){
        img.src = 'https://i.imgur.com/QmZCJyP.jpeg';
    }
	questionBanner.replaceWith(img);
}

function tunnel(new_q){

}  
    if(Knowland == 6){
        var id = campaignTrail_temp.candidate_json.map(p=>p.pk).indexOf(117)
        e.candidate_json[id].fields.first_name = "William F."
        e.candidate_json[id].fields.last_name = "Knowland" 
        
        campaignTrail_temp.candidate_image_url = 'https://i.imgur.com/ZLmms8y.png';
        campaignTrail_temp.running_mate_image_url = 'https://i.imgur.com/IhEpj2q.png';
    }
    else {
        campaignTrail_temp.candidate_image_url = 'https://i.imgur.com/SXLWUbU.png';
        campaignTrail_temp.running_mate_image_url = 'https://i.imgur.com/NGWR7DG.png';
    }
}

let gameWindowNode = document.getElementById("game_window");
let candidateWatcherConfig = { attributes: true, childList: true, subtree: true };
let questionConfig = { attributes: true, childList: true, subtree: true };

function updateQuestions(mutationList, observer) {
    const answers = document.getElementsByClassName("game_answers");

    for (let i = 0; i < answers.length; i++) {
        const answer = answers[i];
        if (answer.classList.contains("done")) {
            continue;
        }
        answer.classList.add("done");

        let answerObject = campaignTrail_temp.answers_json.filter((x) => x.pk == answer.value)[0];

        if (answerObject.fields.condition != null) {
            answer.disabled = !(eval(answerObject.fields.condition));
        } 
    }
}

const questionObserver = new MutationObserver(updateQuestions);
questionObserver.observe(gameWindowNode, questionConfig);

const candidateObserver = new MutationObserver(onGameWindowChangeCandidates);
candidateObserver.observe(gameWindowNode, candidateWatcherConfig);

cyoAdventure = function(a) {
    ans = campaignTrail_temp.player_answers[campaignTrail_temp.player_answers.length-1];
    e.noCounter += 1

    // Dementia Moments
    if(ans == 3897){
        knowland += 1;
    }
    if(ans == 3896){
        knowland += 2;
    }
    if(ans == 3904){
        knowland += 2;
    }
    if(ans == 3872){
        knowland += 1;
    }
    if(ans == 3873){
        knowland += 2;
    }
    if(ans == 3906){
        lodge += 1;
    }
    if(ans == 13760){
        goldwater += 1;
    }
    if(ans == 13768){
        straton += 1;
    }
    if(ans == 13781){
        mckay += 1;
    }

    // Question CYOA
    
    // knowland rnc
    if(knowland >= 6){
         knowland= 6;
        campaignTrail_temp.questions_json[12] = tunnel(13695);   
    }
    // knowland Candidate Campaigning
    if(knowland == 1){
        campaignTrail_temp.questions_json[14] = tunnel(1305); 
        e.global_parameter_json[0].fields.question_count = 13;
    }
        }
    }
